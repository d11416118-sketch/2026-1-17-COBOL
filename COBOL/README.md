========================================================================
           COBOL x Python 混合架構點餐系統 - 使用者操作手冊
========================================================================

本手冊將引導您在新電腦 (Linux/WSL 環境) 上部署並執行本系統。
系統架構：前端 (HTML/JS) + 後端 (Python Flask) + 核心運算 (COBOL)。

目錄：
1. [準備工作] 檔案確認
2. [環境安裝] 安裝必要軟體
3. [專案設定] 編譯 COBOL 與初始化
4. [啟動系統] 執行伺服器
5. [操作說明] 顧客端與店員端
6. [進階功能] 手機連線方式
7. [疑難排解] 常見錯誤處理

------------------------------------------------------------------------
1. [準備工作] 檔案確認
------------------------------------------------------------------------
請確認您的專案資料夾內包含以下檔案與目錄：

📂 專案資料夾
 ├── app.py           (Python 主程式)
 ├── drink.cbl        (COBOL 原始碼)
 ├── index.html       (顧客點餐介面)
 ├── admin.html       (店員管理介面)
 └── static/          (圖片資料夾)
      ├── black_tea.png
      ├── milk_tea.png
      ├── green_tea.png
      ├── oolong.png
      └── latte.png

------------------------------------------------------------------------
2. [環境安裝] 安裝必要軟體
------------------------------------------------------------------------
請開啟終端機 (Terminal)，依序輸入以下指令來安裝 Python、Flask 網頁框架與 COBOL 編譯器。

(1) 更新系統清單：
    sudo apt update

(2) 安裝所有核心套件 (一次安裝完成)：
    sudo apt install python3 python3-pip python3-flask gnucobol -y

    * 注意：我們使用 apt 安裝 flask 以避免權限錯誤。

------------------------------------------------------------------------
3. [專案設定] 編譯 COBOL 與初始化
------------------------------------------------------------------------
在執行 Python 之前，必須先編譯 COBOL 程式，並清理舊資料庫。

(1) 進入您的專案資料夾 (假設資料夾在桌面上)：
    cd 您的專案路徑
    (例如：cd /mnt/c/Users/User/Desktop/COBOL_Project)

(2) 編譯 COBOL 核心：
    cobc -x -o drink.exe drink.cbl

    * 若無錯誤訊息，代表編譯成功，資料夾內會出現 drink.exe。

(3) 初始化資料庫 (刪除舊檔以防衝突)：
    rm -f shop.db

    * 程式啟動時會自動建立新的 shop.db，確保欄位是最新的。

------------------------------------------------------------------------
4. [啟動系統] 執行伺服器
------------------------------------------------------------------------
(1) 在終端機輸入：
    python3 app.py

(2) 當您看到以下訊息，代表系統已成功啟動：
    * Running on http://0.0.0.0:5000
    * Press CTRL+C to quit

    * 注意：請勿關閉此終端機視窗，關閉視窗即停止服務。

------------------------------------------------------------------------
5. [操作說明] 顧客端與店員端
------------------------------------------------------------------------
請開啟電腦上的瀏覽器 (Chrome/Edge)，輸入以下網址：

【顧客自助點餐端】(給客人用)
網址：http://127.0.0.1:5000/
功能：
  1. 瀏覽圖片菜單。
  2. 點擊卡片選擇「甜度」、「冰塊」與「數量」。
  3. 加入購物車後，點擊「確認結帳」。
  4. 系統會跳出收據視窗，並清空購物車。

【店員後台管理端】(給老闆用)
網址：http://127.0.0.1:5000/admin
功能：
  1. 上方顯示「待製作訂單 (Pending)」(黃色區塊)。
  2. 飲料製作完成後，點擊綠色的「出餐 ✅」按鈕。
  3. 訂單會移動到下方的「今日已完成 (History)」(灰色區塊)。
  4. 每 30 秒頁面會自動刷新，也可手動按刷新按鈕。

------------------------------------------------------------------------
6. [進階功能] 手機連線方式
------------------------------------------------------------------------
若希望讓同一 Wi-Fi 環境下的手機也能點餐：

(1) 查詢電腦 IP：
    在終端機輸入：ip a  (或 ifconfig)
    尋找 inet 192.168.x.x 開頭的位址。

(2) 手機連線：
    手機瀏覽器輸入：http://[電腦IP]:5000
    (例如：http://192.168.1.105:5000)

------------------------------------------------------------------------
7. [疑難排解] 常見錯誤處理
------------------------------------------------------------------------
Q1: 出現 "sqlite3.OperationalError: no such column: options" ?
A1: 資料庫版本過舊。請關閉程式 (Ctrl+C)，執行 `rm shop.db` 刪除資料庫，再重新啟動。

Q2: 出現 "FileNotFoundError: ... drink.exe" ?
A2: COBOL 尚未編譯或編譯失敗。請執行步驟 3 的 `cobc` 指令。

Q3: 手機連不上網頁 ?
A3: 請確認手機與電腦連線同一個 Wi-Fi，並檢查電腦防火牆是否阻擋了 5000 Port。

Q4: 圖片顯示不出來 ?
A4: 請確認圖片檔名是否正確 (應為 .png)，且必須放在 static 資料夾內。

========================================================================