<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>1959 製茶所 | 金融級手作茶飲 (Powered by COBOL)</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23e11d48%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><path d=%22M6 2h12l-2 14H8L6 2z%22/><path d=%22M10 22h4%22/><path d=%22M12 16v6%22/><path d=%22M18 2h2v3c0 1.66-1.34 3-3 3h-1%22/></svg>">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body class="bg-gray-50 pb-20">

    <!-- Header -->
    <nav class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-gray-100">
        <div class="max-w-4xl mx-auto px-4 h-20 flex items-center justify-between">
            <a href="#" class="flex items-center space-x-3 group">
                <!-- Artisan Badge Logo -->
                <div class="relative flex items-center justify-center">
                    <svg class="w-14 h-14 text-rose-600 transform group-hover:rotate-12 transition-transform duration-500"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2">
                        <!-- Tech Hexagon Border -->
                        <path d="M12 2L3.5 7v10L12 22l8.5-5V7L12 2z" stroke-dasharray="2 1" opacity="0.3" />
                        <path d="M12 4L5 8v8l7 4 7-4V8l-7-4z" stroke-width="1.5" />
                        <!-- Decorative Tech Dots -->
                        <circle cx="12" cy="4" r="0.5" fill="currentColor" />
                        <circle cx="12" cy="20" r="0.5" fill="currentColor" />
                        <circle cx="5" cy="8" r="0.5" fill="currentColor" />
                        <circle cx="19" cy="8" r="0.5" fill="currentColor" />
                        <!-- Cup Icon Center -->
                        <g transform="translate(7, 7.5) scale(0.42)">
                            <path d="M6 2h12l-2 14H8L6 2z" stroke-width="3" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <path d="M18 2h2v3c0 1.66-1.34 3-3 3h-1" stroke-width="3" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <path d="M10 22h4" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M12 16v6" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                        </g>
                    </svg>
                    <div
                        class="absolute inset-0 bg-rose-600/5 rounded-full scale-0 group-hover:scale-110 transition-transform duration-500 blur-xl">
                    </div>
                </div>
                <div class="flex flex-col">
                    <span class="text-xl font-bold text-gray-900 leading-none tracking-tight font-serif mb-1">1959
                        製茶所</span>
                    <span class="text-[10px] font-mono text-gray-400 tracking-[0.2em] uppercase">Since 1959</span>
                </div>
            </a>

            <div class="flex items-center space-x-3">
                <div id="guest-area" class="flex space-x-2">
                    <button onclick="openModal('login-modal')"
                        class="text-sm font-medium text-gray-600 hover:text-rose-600 transition">登入</button>
                    <button onclick="openModal('register-modal')"
                        class="bg-rose-600 text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-rose-700 transition shadow-sm">註冊</button>
                </div>
                <div id="user-area" class="hidden flex items-center space-x-4">
                    <div class="flex flex-col items-end">
                        <span class="text-xs text-gray-400">歡迎回來</span>
                        <span id="nav-username" class="text-sm font-bold text-gray-800">使用者</span>
                    </div>
                    <button onclick="fetchHistory()" class="p-2 text-gray-400 hover:text-rose-600 transition">
                        <i data-lucide="history" class="w-5 h-5"></i>
                    </button>
                    <button onclick="logout()" class="p-2 text-gray-400 hover:text-red-500 transition">
                        <i data-lucide="log-out" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <div class="relative rounded-3xl overflow-hidden shadow-xl mb-8 group h-64 md:h-80">
            <!-- Background Image -->
            <img src="/static/banner.png" alt="Hero Banner"
                class="absolute inset-0 w-full h-full object-cover transition duration-700 group-hover:scale-105">
            <!-- Gradient Overlay -->
            <div class="absolute inset-0 bg-gradient-to-r from-rose-900/80 via-rose-800/40 to-transparent"></div>

            <div class="relative z-10 h-full flex flex-col justify-center p-8 md:p-12 max-w-sm">
                <h2 class="text-3xl md:text-4xl font-extrabold text-white mb-2 drop-shadow-md">渴了嗎？</h2>
                <p class="text-rose-50 text-sm md:text-base mb-6 drop-shadow-sm">數十種嚴選茶飲，現在下單即刻為您製作。</p>
                <div class="flex">
                    <div
                        class="bg-white/90 backdrop-blur text-rose-600 px-6 py-2 rounded-full font-bold shadow-lg text-sm">
                        新品上市 8 折起
                    </div>
                </div>
            </div>
        </div>

        <!-- Menu Header & Horizontal Categories -->
        <div class="mb-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">精選菜單</h3>
            <div class="flex overflow-x-auto whitespace-nowrap space-x-3 scrollbar-hide pb-2">
                <button onclick="filterMenu('all', this)"
                    class="category-btn active px-6 py-2 rounded-full text-sm font-bold transition-all border border-gray-200 bg-rose-600 text-white shadow-md shadow-rose-100">全部</button>
                <button onclick="filterMenu('tea', this)"
                    class="category-btn px-6 py-2 rounded-full text-sm font-bold transition-all border border-gray-200 bg-white text-gray-500 hover:bg-gray-50">原味茶</button>
                <button onclick="filterMenu('milk', this)"
                    class="category-btn px-6 py-2 rounded-full text-sm font-bold transition-all border border-gray-200 bg-white text-gray-500 hover:bg-gray-50">鮮奶系列</button>
                <button onclick="filterMenu('milktea', this)"
                    class="category-btn px-6 py-2 rounded-full text-sm font-bold transition-all border border-gray-200 bg-white text-gray-500 hover:bg-gray-50">傳統奶茶</button>
                <button onclick="filterMenu('fruit', this)"
                    class="category-btn px-6 py-2 rounded-full text-sm font-bold transition-all border border-gray-200 bg-white text-gray-500 hover:bg-gray-50">鮮果特調</button>
            </div>
        </div>

        <!-- Menu Container -->
        <div id="menu-container" class="grid grid-cols-2 md:grid-cols-3 gap-4">
            <!-- Products will be injected here -->
            <div class="animate-pulse bg-gray-200 rounded-2xl h-60"></div>
            <div class="animate-pulse bg-gray-200 rounded-2xl h-60"></div>
            <div class="animate-pulse bg-gray-200 rounded-2xl h-60"></div>
        </div>
    </div>

    <!-- Floating Cart Button -->
    <button onclick="openModal('cart-modal')"
        class="cart-float fixed bottom-6 right-6 bg-amber-500 text-white p-4 rounded-full shadow-2xl hover:bg-amber-600 transition-all z-40 transform hover:scale-110 active:scale-95">
        <i data-lucide="shopping-cart" class="w-6 h-6"></i>
        <span id="cart-count"
            class="hidden absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-bold w-5 h-5 flex items-center justify-center rounded-full border-2 border-white">0</span>
    </button>

    <!-- Modals Container -->
    <div id="modals">

        <!-- Login Modal -->
        <div id="login-modal" class="modal-container hidden fixed inset-0 z-50 flex items-center justify-center px-4">
            <div class="backdrop fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
            <div class="modal-content relative bg-white w-full max-w-sm rounded-[2rem] p-8 shadow-2xl">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">歡迎回來</h2>
                    <p class="text-gray-400">請輸入您的帳號密碼</p>
                </div>
                <div class="space-y-4">
                    <div class="relative">
                        <i data-lucide="phone" class="absolute left-3 top-3 w-5 h-5 text-gray-300"></i>
                        <input type="text" id="login-phone" placeholder="手機號碼"
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition">
                    </div>
                    <div class="relative">
                        <i data-lucide="lock" class="absolute left-3 top-3 w-5 h-5 text-gray-300"></i>
                        <input type="password" id="login-pwd" placeholder="密碼"
                            class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition">
                    </div>
                    <button onclick="login()"
                        class="w-full bg-rose-600 text-white py-4 rounded-2xl font-bold hover:bg-rose-700 transition transformactive:scale-95 shadow-lg shadow-rose-200">登入</button>
                    <p class="text-center text-sm text-gray-400">還沒有帳號？ <button
                            onclick="closeModal('login-modal');openModal('register-modal')"
                            class="text-rose-600 font-bold">立即註冊</button></p>
                </div>
                <button onclick="closeModal('login-modal')"
                    class="absolute top-4 right-4 text-gray-300 hover:text-gray-500"><i data-lucide="x"
                        class="w-6 h-6"></i></button>
            </div>
        </div>

        <!-- Register Modal -->
        <div id="register-modal"
            class="modal-container hidden fixed inset-0 z-50 flex items-center justify-center px-4">
            <div class="backdrop fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
            <div class="modal-content relative bg-white w-full max-w-sm rounded-[2rem] p-8 shadow-2xl">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">建立帳號</h2>
                    <p class="text-gray-400">成為會員享有更多優惠</p>
                </div>
                <div class="space-y-4">
                    <input type="text" id="reg-name" placeholder="姓名"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition">
                    <div class="flex space-x-2">
                        <input type="text" id="reg-phone" placeholder="手機號碼"
                            class="flex-1 px-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition">
                        <button onclick="sendOtp()" id="btn-otp"
                            class="whitespace-nowrap px-4 bg-gray-800 text-white rounded-2xl text-xs font-bold hover:bg-gray-700 transition">傳送碼</button>
                    </div>
                    <input type="text" id="reg-otp" placeholder="驗證碼 (查看黑畫面)"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition">
                    <input type="password" id="reg-pwd" placeholder="設定密碼"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition">
                    <button onclick="register()"
                        class="w-full bg-rose-600 text-white py-4 rounded-2xl font-bold hover:bg-rose-700 transition transform active:scale-95">完成註冊</button>
                </div>
                <button onclick="closeModal('register-modal')"
                    class="absolute top-4 right-4 text-gray-300 hover:text-gray-500"><i data-lucide="x"
                        class="w-6 h-6"></i></button>
            </div>
        </div>

        <!-- Option Modal -->
        <div id="option-modal"
            class="modal-container hidden fixed inset-0 z-50 flex items-end md:items-center justify-center px-0 md:px-4">
            <div class="backdrop fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
            <div
                class="modal-content relative bg-white w-full max-w-lg rounded-t-[2.5rem] md:rounded-[2.5rem] p-8 shadow-2xl overflow-hidden">
                <div class="flex space-x-6 mb-8">
                    <div class="w-32 h-32 bg-gray-50 rounded-3xl p-2 flex-shrink-0">
                        <img id="modal-img" src="" class="w-full h-full object-contain">
                    </div>
                    <div>
                        <h2 id="modal-title" class="text-2xl font-extrabold text-gray-800 mb-1">飲品名稱</h2>
                        <div id="modal-price" class="text-xl font-bold text-rose-600 mb-2">$0</div>
                        <p class="text-sm text-gray-400">客製化您的飲品，滿足不同心情。</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-3">甜度選擇</label>
                        <select id="sugar"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition appearance-none">
                            <option>正常糖</option>
                            <option>半糖</option>
                            <option>微糖</option>
                            <option>無糖</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-3">冰塊選擇</label>
                        <select id="ice"
                            class="w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-2xl focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition appearance-none">
                            <option>正常冰</option>
                            <option>少冰</option>
                            <option>微冰</option>
                            <option>去冰</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between pt-4 border-t border-gray-50">
                        <div class="flex items-center bg-gray-100 rounded-2xl p-1">
                            <button onclick="document.getElementById('qty').stepDown()"
                                class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-white transition"><i
                                    data-lucide="minus" class="w-4 h-4"></i></button>
                            <input type="number" id="qty" value="1" min="1"
                                class="w-12 text-center bg-transparent border-none font-bold focus:ring-0">
                            <button onclick="document.getElementById('qty').stepUp()"
                                class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-white transition"><i
                                    data-lucide="plus" class="w-4 h-4"></i></button>
                        </div>
                        <button onclick="addToCartConfirm()"
                            class="bg-rose-600 text-white px-8 py-4 rounded-2xl font-bold hover:bg-rose-700 transition shadow-lg shadow-rose-200">加入購物車</button>
                    </div>
                </div>
                <button onclick="closeModal('option-modal')"
                    class="absolute top-6 right-6 text-gray-300 hover:text-gray-500"><i data-lucide="x"
                        class="w-6 h-6"></i></button>
            </div>
        </div>

        <!-- Cart Modal -->
        <div id="cart-modal" class="modal-container hidden fixed inset-0 z-50 flex items-center justify-end">
            <div class="backdrop fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
            <div class="modal-content relative bg-white w-full max-w-sm h-full shadow-2xl flex flex-col">
                <div class="p-6 border-b border-gray-50 flex items-center justify-between">
                    <h2 class="text-xl font-bold text-gray-800">您的購物車</h2>
                    <button onclick="closeModal('cart-modal')" class="text-gray-300 hover:text-gray-500"><i
                            data-lucide="x" class="w-6 h-6"></i></button>
                </div>

                <div id="cart-items" class="flex-1 overflow-y-auto p-6 scrollbar-hide">
                    <!-- Items injected here -->
                </div>

                <div class="p-6 bg-gray-50 rounded-t-[2.5rem] shadow-inner">
                    <div id="guest-info-form" class="space-y-3 mb-6">
                        <p class="text-xs font-bold text-gray-400 uppercase tracking-widest">取餐資料</p>
                        <input type="text" id="c-name" placeholder="稱呼 (例：王先生)"
                            class="w-full px-4 py-3 bg-white border border-gray-100 rounded-2xl focus:outline-none transition">
                        <input type="text" id="c-phone" placeholder="聯絡電話"
                            class="w-full px-4 py-3 bg-white border border-gray-100 rounded-2xl focus:outline-none transition">
                    </div>
                    <div id="user-info-display"
                        class="hidden mb-6 flex items-center space-x-3 bg-white p-4 rounded-2xl border border-rose-100">
                        <div class="bg-rose-100 p-2 rounded-lg"><i data-lucide="user" class="w-5 h-5 text-rose-600"></i>
                        </div>
                        <div>
                            <p class="text-xs text-gray-400">登入會員</p>
                            <p id="display-user" class="font-bold text-gray-800"></p>
                        </div>
                    </div>

                    <div class="flex items-center justify-between mb-6">
                        <span class="text-gray-500">總計金額</span>
                        <span id="cart-total" class="text-2xl font-black text-rose-600">$0</span>
                    </div>
                    <button onclick="checkout()"
                        class="w-full bg-rose-600 text-white py-4 rounded-2xl font-bold hover:bg-rose-700 transition shadow-xl shadow-rose-200">立即結帳</button>
                </div>
            </div>
        </div>

        <!-- History Modal -->
        <div id="history-modal" class="modal-container hidden fixed inset-0 z-50 flex items-center justify-center px-4">
            <div class="backdrop fixed inset-0 bg-black/40 backdrop-blur-sm"></div>
            <div
                class="modal-content relative bg-gray-50 w-full max-w-lg h-[80vh] rounded-[2.5rem] flex flex-col shadow-2xl overflow-hidden">
                <div class="p-8 bg-white border-b border-gray-100">
                    <h2 class="text-2xl font-bold text-gray-800">歷史訂單</h2>
                </div>
                <div id="history-list" class="flex-1 overflow-y-auto p-6 space-y-4">
                    <!-- History items injected here -->
                </div>
                <button onclick="closeModal('history-modal')"
                    class="absolute top-8 right-8 text-gray-300 hover:text-gray-500"><i data-lucide="x"
                        class="w-6 h-6"></i></button>
            </div>
        </div>

    </div>

    <!-- Scripts -->
    <script src="/static/js/app.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>

</html>